<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "file:///home/nico/I-Ds/kitten/../test/src/../data/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.0.0" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Simplified and Asynchronous Security Context Interfaces for the Generic Security Services Application Programming Interface</title>

<!-- Text Class Preamble -->
<style type="text/css">
div.toc {
margin: 2em 0em;
border-style: solid;
border-width: 2px 0px;
padding: 1em 0em;
}
div.tochead { font-size: x-large; font-weight: bold; }
div.lyxtoc-0 {
margin: 2em 0em 0em 0em;
font-size: xx-large;
font-weight: bold;
}
div.lyxtoc-1 {
margin: 1em 0em 0em 0em;
font-size: x-large;
font-weight: bold;
}
div.lyxtoc-2 {
margin: 0em 0em 0em 1em;
font-size: large;
font-weight: normal;
}
div.lyxtoc-3 { margin: 0em 0em 0em 0.5em; font-size: medium; }
div.lyxtoc-4 { margin: 0em 0em 0em 0.5em; }
div.lyxtoc-5 { margin: 0em 0em 0em 0.5em; }
div.lyxtoc-6 { margin: 0em 0em 0em 0.5em; }
a.tocentry {
text-decoration: none;
color: black;
}
a.tocentry:visited { color: black; }
a.tocarrow {
font-weight: bold;
text-decoration: none;
color: #909090;
}
a.tocarrow:visited { color: #C0C0C0; }
</style>

<!-- Preamble Snippets -->

<!-- Layout-provided Styles -->
<style type='text/css'>
h1.title {
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
div.author {
font-size: large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.abstract {
font-size: small;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
margin-right: 3ex;
text-align: left;

}
div.abstract_label {
font-weight: bold;
font-size: large;
text-align: center;

}

div.abstract {
margin: 4ex;
}
div.abstract_item {
font-size: small;
padding-top: 1ex;
}
div.abstract_label {
font-weight: bold;
}
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h4.subsubsection {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
dl.description dt { font-weight: bold; }
div.flex_docname {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_ipr {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_intendedstatus {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_titleabbrev {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_ietfarea {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_xml_rfckeyword {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_updates {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_pi_toc {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_pi_symrefs {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_pi_tocindent {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_pi {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authororg {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authororgabbrev {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authoremailaddr {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_entityxref {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.listings {
font-family: monospace;
}
div.flex_bibxml {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
</style>
</head>
<body>
<h1 class="title"><a id='magicparlabel-1' />
Simplified and Asynchronous Security Context Interfaces for the Generic Security Services Application Programming Interface</h1>
<div class="standard"><a id='magicparlabel-2' />
<div class="flex_docname"><div class="plain_layout"><a id='magicparlabel-6' />
draft-williams-kitten-ctx-simple-async-00</div>
</div><div class="flex_ipr"><div class="plain_layout"><a id='magicparlabel-10' />
trust200902</div>
</div><div class="flex_intendedstatus"><div class="plain_layout"><a id='magicparlabel-14' />
std</div>
</div><div class="flex_titleabbrev"><div class="plain_layout"><a id='magicparlabel-18' />
Simple GSS</div>
</div><div class="flex_ietfarea"><div class="plain_layout"><a id='magicparlabel-22' />
Security Area</div>
</div><div class="flex_xml_rfckeyword"><div class="plain_layout"><a id='magicparlabel-26' />
Internet-Draft</div>
</div><div class="flex_updates"><div class="plain_layout"><a id='magicparlabel-30' />
RFC2743 RFC2744</div>
</div></div>

<div class="standard"><a id='magicparlabel-31' />
<div class="flex_pi_toc"><div class="plain_layout"><a id='magicparlabel-35' />
yes</div>
</div><div class="flex_pi_symrefs"><div class="plain_layout"><a id='magicparlabel-39' />
yes</div>
</div><div class="flex_pi_tocindent"><div class="plain_layout"><a id='magicparlabel-43' />
no</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-47' />
comments="yes"</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-51' />
inline="yes"</div>
</div></div>

<div class="author"><div class="author_item"><a id='magicparlabel-52' />
Nicolas Williams<div class="flex_authororg"><div class="plain_layout"><a id='magicparlabel-56' />
Cryptonector, LLC</div>
</div><div class="flex_authororgabbrev"><div class="plain_layout"><a id='magicparlabel-60' />
Cryptonector</div>
</div><div class="flex_authoremailaddr"><div class="plain_layout"><a id='magicparlabel-64' />
nico@cryptonector.com</div>
</div></div>
</div>

<div class="abstract"><div class="abstract_label">Abstract</div>
<div class="abstract_item"><a id='magicparlabel-65' />
This Internet-Draft proposes extensions to the Generic Security Services Application Programming Interface (GSS-API) for replacing the exiting GSS_Init_sec_context() and GSS_Accept_sec_context() functions with simplified forms that also support asynchrony.</div>
</div>
<div class="standard"><a id='magicparlabel-66' />
</div>
<div class='toc'><div class='tochead part_'>Table of Contents</div>

<div class='lyxtoc-1'><a href='#magicparlabel-67' class='tocentry'>1 Introduction</a> <a href='#magicparlabel-67' class='tocarrow'>&gt;</a>

<div class='lyxtoc-2'><a href='#magicparlabel-69' class='tocentry'>1.1 Conventions used in this document</a> <a href='#magicparlabel-69' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-75' class='tocentry'>2 Simplified API</a> <a href='#magicparlabel-75' class='tocarrow'>&gt;</a>

<div class='lyxtoc-2'><a href='#magicparlabel-90' class='tocentry'>2.1 GSS_Create_sec_context()</a> <a href='#magicparlabel-90' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-102' class='tocentry'>2.1.1 C-Bindings</a> <a href='#magicparlabel-102' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-110' class='tocentry'>2.2 GSS_Set_context_flags()</a> <a href='#magicparlabel-110' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-127' class='tocentry'>2.2.1 C-Bindings</a> <a href='#magicparlabel-127' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-137' class='tocentry'>2.3 GSS_Set_context_credentials()</a> <a href='#magicparlabel-137' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-150' class='tocentry'>2.3.1 C-Bindings</a> <a href='#magicparlabel-150' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-159' class='tocentry'>2.4 GSS_Set_context_channel_bindings()</a> <a href='#magicparlabel-159' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-170' class='tocentry'>2.4.1 C-Bindings</a> <a href='#magicparlabel-170' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-179' class='tocentry'>2.5 GSS_Set_context_lifetime()</a> <a href='#magicparlabel-179' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-190' class='tocentry'>2.5.1 C-Bindings</a> <a href='#magicparlabel-190' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-199' class='tocentry'>2.6 GSS_Set_async_IO_notification()</a> <a href='#magicparlabel-199' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-216' class='tocentry'>2.6.1 C-Bindings</a> <a href='#magicparlabel-216' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-259' class='tocentry'>2.7 GSS_Set_event_loop()</a> <a href='#magicparlabel-259' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-283' class='tocentry'>2.7.1 C-Bindings</a> <a href='#magicparlabel-283' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-308' class='tocentry'>2.8 GSS_Indicate_event_loop_types()</a> <a href='#magicparlabel-308' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-319' class='tocentry'>2.8.1 C-Bindings</a> <a href='#magicparlabel-319' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-328' class='tocentry'>2.9 GSS_Set_context_role_init()</a> <a href='#magicparlabel-328' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-342' class='tocentry'>2.9.1 C-Bindings</a> <a href='#magicparlabel-342' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-2'><a href='#magicparlabel-352' class='tocentry'>2.10 GSS_Step_context()</a> <a href='#magicparlabel-352' class='tocarrow'>&gt;</a>

<div class='lyxtoc-3'><a href='#magicparlabel-370' class='tocentry'>2.10.1 C-Bindings</a> <a href='#magicparlabel-370' class='tocarrow'>&gt;</a></div>
</div>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-381' class='tocentry'>3 Security Considerations</a> <a href='#magicparlabel-381' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-383' class='tocentry'>4 IANA Considerations</a> <a href='#magicparlabel-383' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-385' class='tocentry'>5 Normative References</a> <a href='#magicparlabel-385' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-411' class='tocentry'>6 Informative References</a> <a href='#magicparlabel-411' class='tocarrow'>&gt;</a></div>
</div>

<h2 class="section"><span class="section_label">1</span> <a id='magicparlabel-67' />
Introduction</h2>
<div class="standard"><a id='magicparlabel-68' />
We propose replacing the GSS_Init_sec_context() and GSS_Accept_sec_context() functions with a set of simpler functions: one to create an &ldquo;empty&rdquo; security context, a set of functions to set context parameters, a single function for &ldquo;stepping&rdquo; the security context token exchange, and additional security context inquiry functions. Support for non-blocking stepping of security context token exchange is also included.</div>
<h3 class="subsection"><span class="subsection_label">1.1</span> <a id='magicparlabel-69' />
Conventions used in this document</h3>
<div class="standard"><a id='magicparlabel-70' />
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-74' />
RFC2119</div>
</div>.</div>
<h2 class="section"><span class="section_label">2</span> <a id='magicparlabel-75' />
Simplified API</h2>
<div class="standard"><a id='magicparlabel-76' />
We add a function for creating &ldquo;empty&rdquo; security contexts:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-77' />
GSS_Create_sec_context()</li>
</ul>
<div class="standard"><a id='magicparlabel-78' />
We add the following new mutator functions for empty security contexts:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-79' />
GSS_Set_context_flags()</li>
<li class="itemize_item"><a id='magicparlabel-80' />
GSS_Set_context_credentials()</li>
<li class="itemize_item"><a id='magicparlabel-81' />
GSS_Set_context_role_init()</li>
<li class="itemize_item"><a id='magicparlabel-82' />
GSS_Set_context_channel_bindings()</li>
<li class="itemize_item"><a id='magicparlabel-83' />
GSS_Set_context_lifetime()</li>
<li class="itemize_item"><a id='magicparlabel-84' />
GSS_Set_async_IO_notification()</li>
<li class="itemize_item"><a id='magicparlabel-85' />
GSS_Set_async_event_loop()</li>
</ul>
<div class="standard"><a id='magicparlabel-86' />
We add a function for stepping through security context token exchanges:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-87' />
GSS_Step_context()</li>
</ul>
<div class="standard"><a id='magicparlabel-88' />
We add a function for retrieving delegated credentials from a security context token:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-89' />
GSS_Get_context_deleg_cred()</li>
</ul>
<h3 class="subsection"><span class="subsection_label">2.1</span> <a id='magicparlabel-90' />
GSS_Create_sec_context()</h3>
<div class="standard"><a id='magicparlabel-91' />
Inputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-92' />
&lt;none&gt;</li>
</ul>
<div class="standard"><a id='magicparlabel-93' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-94' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-95' />
minor_status INTEGER &ndash; note: mostly useless, but we should keep it</li>
<li class="itemize_item"><a id='magicparlabel-96' />
context SECURITY CONTEXT</li>
</ul>
<div class="standard"><a id='magicparlabel-97' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-98' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-99' />
GSS_S_UNAVAILABLE indicates that memory is not available, for example.</li>
<li class="itemize_item"><a id='magicparlabel-100' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-101' />
This function creates an &ldquo;empty&rdquo; security context handle that can be passed to GSS_Init_sec_context() or GSS_Accept_sec_context() where they expect a NULL context. The context can also be passed to the other new security context functions defined in this document.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.1.1</span> <a id='magicparlabel-102' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-103' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_create_sec_context(OM_uint32 *minor_status,
                        gss_ctx_id_t *context);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.2</span> <a id='magicparlabel-110' />
GSS_Set_context_flags()</h3>
<div class="standard"><a id='magicparlabel-111' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-112' />
 </dd>
<dt class="description_label">req_flags&nbsp;FLAGS</dt>
<dd class="description_item"><a id='magicparlabel-113' />
 Requested flags. Applicable to acceptors and initiators.</dd>
<dt class="description_label">ret_flags_understood&nbsp;FLAGS</dt>
<dd class="description_item"><a id='magicparlabel-114' />
 Return flags understood by the caller.</dd>
</dl>
<div class="standard"><a id='magicparlabel-115' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-116' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-117' />
minor_status INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-118' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-119' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-120' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-121' />
This function tells the mechanism (when one is eventually chosen and invoked) that the application requests the given req_flags and undestands the given ret_flags. Initiators can override the req_flags in their GSS_Init_sec_context() call, but if no flags are requested there then the req_flags set on the empty context will be used.</div>

<div class="standard"><a id='magicparlabel-122' />
NOTE: The abstract GSS-API <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-126' />
RFC2743</div>
</div> uses individual elements -one per-flag- instead of a &ldquo;FLAGS&rdquo; type. This is unwieldy, therefore we introduce an abstract type named &ldquo;FLAGS&rdquo; to act as a set of all the request/return flags defined for the abstract GSS-API.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.2.1</span> <a id='magicparlabel-127' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-128' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_set_context_flags(OM_uint32 *minor_status,
                       gss_ctx_id_t context,
                       uint64_t req_flags,
                       uint64_t ret_flags);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.3</span> <a id='magicparlabel-137' />
GSS_Set_context_credentials()</h3>
<div class="standard"><a id='magicparlabel-138' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-139' />
 Empty security context</dd>
<dt class="description_label">input_cred_handle&nbsp;CREDENTIAL&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-140' />
 MUST NOT be the default credential.</dd>
</dl>
<div class="standard"><a id='magicparlabel-141' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-142' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-143' />
minor_status INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-144' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-145' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-146' />
...</li>
<li class="itemize_item"><a id='magicparlabel-147' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-148' />
This function sets the application's credentials. If no credentials are set then the default credentials will be used.</div>

<div class="standard"><a id='magicparlabel-149' />
Multiple credentials may be set on a security context. The mechanism SHOULD allow accepting security contexts for any principals for which credentials had elements for the mechanism used. The mechanism SHOULD allow initiators to have multiple credentials, in which case the mechanism should select the credential most likely to succeed for the given target principal. Where a mechanism does not support multiple credentials it MUST use the first credential handle set by the application.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.3.1</span> <a id='magicparlabel-150' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-151' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_set_context_credentials(OM_uint32 *minor_status,
                             gss_ctx_id_t context,
                             gss_const_cred_id_t input_cred_handle);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.4</span> <a id='magicparlabel-159' />
GSS_Set_context_channel_bindings()</h3>
<div class="standard"><a id='magicparlabel-160' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-161' />
 Empty security context</dd>
<dt class="description_label">input_channel_bindings&nbsp;OCTET&nbsp;STRING</dt>
<dd class="description_item"><a id='magicparlabel-162' />
</dd>
</dl>
<div class="standard"><a id='magicparlabel-163' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-164' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-165' />
minor_status INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-166' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-167' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-168' />
...</li>
<li class="itemize_item"><a id='magicparlabel-169' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<h4 class="subsubsection"><span class="subsubsection_label">2.4.1</span> <a id='magicparlabel-170' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-171' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_set_context_channel_bindings(OM_uint32 *minor_status,
                                  gss_ctx_id_t context,
                                  gss_const_buffer_t input_cb);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.5</span> <a id='magicparlabel-179' />
GSS_Set_context_lifetime()</h3>
<div class="standard"><a id='magicparlabel-180' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-181' />
 Empty security context</dd>
<dt class="description_label">lifetime_req&nbsp;INTEGER</dt>
<dd class="description_item"><a id='magicparlabel-182' />
 ...</dd>
</dl>
<div class="standard"><a id='magicparlabel-183' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-184' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-185' />
minor_status INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-186' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-187' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-188' />
...</li>
<li class="itemize_item"><a id='magicparlabel-189' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<h4 class="subsubsection"><span class="subsubsection_label">2.5.1</span> <a id='magicparlabel-190' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-191' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_set_context_lifetime(OM_uint32 *minor_status,
                          gss_ctx_id_t context,
                          uint64_t lifetime_req);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.6</span> <a id='magicparlabel-199' />
GSS_Set_async_IO_notification()</h3>
<div class="standard"><a id='magicparlabel-200' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-201' />
 Empty security context</dd>
<dt class="description_label">async_notification_method&nbsp;UNSPECIFIED</dt>
<dd class="description_item"><a id='magicparlabel-202' />
</dd>
</dl>
<div class="standard"><a id='magicparlabel-203' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-204' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-205' />
minor_status INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-206' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-207' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-208' />
...</li>
<li class="itemize_item"><a id='magicparlabel-209' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-210' />
This function sets a method for informing the application that the given security context is ready to have GSS_Step_context() called on it. Whenever GSS_Step_context() returns GSS_S_CONTINUE_NEEDED and no output token the application must wait for the async I/O completion notification and then call GSS_Step_context() again (this time with no input token). GSS_Step_context() will only work asynchronously when this function has been used to set a completion notification method.</div>

<div class="standard"><a id='magicparlabel-211' />
The async I/O completion notification method is not specified for the abstract API. In the C bindings we allow for several different notification methods, including:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-212' />
callback function</li>
<li class="itemize_item"><a id='magicparlabel-213' />
file descriptor or file handle into which a single byte (any value) will be written</li>
<li class="itemize_item"><a id='magicparlabel-214' />
a condition variable (and associated mutex) on which a signal will be sent</li>
</ul>
<div class="standard"><a id='magicparlabel-215' />
Other completion notification methods could be specified as well, but these seem likely to be sufficient and reasonably portable.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.6.1</span> <a id='magicparlabel-216' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-217' />
</div>
<div class='float float-listings'><pre> typedef void (*gss_async_cb_t)(gss_ctx_id_t context, void *cb_data);
 
 OM_uint32
 gss_set_context_async_io_cb(OM_uint32 *minor_status,
                             gss_ctx_id_t context,
                             gss_async_cb_t cb,
                             void *cb_data);
 
 OM_uint32
 gss_set_context_async_io_fd(OM_uint32 *minor_status,
                             gss_ctx_id_t context,
                             int fd);
 
 #ifdef HAVE_WIN32
 OM_uint32
 gss_set_context_async_io_handle(OM_uint32 *minor_status,
                                 gss_ctx_id_t context,
                                 HANDLE h);
 #endif /* HAVE_WIN32 */
 
 #ifdef HAVE_PTHREADS
 #include &lt;pthread.h&gt;
 OM_uint32
 gss_set_context_async_io_condvar(OM_uint32 *minor_status,
                                  gss_ctx_id_t context,
                                  pthread_cond_t cv,
                                  pthread_mutex_t lock);
 #endif /* HAVE_PTHREADS */
 
 #ifdef HAVE_WIN32
 #include &lt;windows.h&gt;
 #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt;
 OM_uint32
 gss_set_context_async_io_condvar(OM_uint32 *minor_status,
                                  gss_ctx_id_t context,
                                  CONDITION_VARIABLE cv,
                                  CRITICAL_SECTION lock);
 #endif /* HAVE_WIN32 */</pre></div>

<h3 class="subsection"><span class="subsection_label">2.7</span> <a id='magicparlabel-259' />
GSS_Set_event_loop()</h3>
<div class="standard"><a id='magicparlabel-260' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-261' />
 Empty security context</dd>
<dt class="description_label">event_loop_type&nbsp;INTEGER</dt>
<dd class="description_item"><a id='magicparlabel-262' />
 Type of event loop</dd>
<dt class="description_label">event_loop&nbsp;UNSPECIFIED</dt>
<dd class="description_item"><a id='magicparlabel-263' />
 An event loop</dd>
<dt class="description_label">event_loop_module&nbsp;UNSPECIFIED</dt>
<dd class="description_item"><a id='magicparlabel-264' />
 A module implementing the interface of the given event loop type</dd>
</dl>
<div class="standard"><a id='magicparlabel-265' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-266' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-267' />
minor_status INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-268' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-269' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-270' />
...</li>
<li class="itemize_item"><a id='magicparlabel-271' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-272' />
This function sets an event loop to use by the mechanism. We specify no event loop interfaces here. Instead we allow for the use of existing event loop APIs.</div>

<div class="standard"><a id='magicparlabel-273' />
The following event loop types are defined (but not their interfaces):</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-274' />
EV_NONE (the mechanism MAY run a private event loop in a background thread, but only if the application also set a completion notification method);</li>
<li class="itemize_item"><a id='magicparlabel-275' />
EV_LIBVERTO [<a href="https://fedorahosted.org/libverto/">libverto</a>];</li>
<li class="itemize_item"><a id='magicparlabel-276' />
EV_LIBEVENT [<a href="http://libevent.org/">libevent</a>]</li>
<li class="itemize_item"><a id='magicparlabel-277' />
EV_LIBEV [<a href="http://software.schmorp.de/pkg/libev.html">libev</a>]</li>
<li class="itemize_item"><a id='magicparlabel-278' />
EV_GLIB [<a href="http://developer.gnome.org/glib/stable/">glib</a>]</li>
<li class="itemize_item"><a id='magicparlabel-279' />
EV_TEVENT [<a href="http://tevent.samba.org/">tevent</a>]</li>
<li class="itemize_item"><a id='magicparlabel-280' />
EV_GCD [<a href="https://libdispatch.macosforge.org/">Grand Central Dispatch</a>]</li>
</ul>
<div class="standard"><a id='magicparlabel-281' />
Asynchronous security context stepping is OPTIONAL. It is RECOMMENDED that mechanisms implement EV_LIBVERTO. Note that if the application's choice of event loop is not supported by a mechanism then GSS_Step_context() will return GSS_S_UNAVAILABLE_EVENT_LOOP_TYPE, in which case the application may try another event loop type, likely EV_NONE.</div>

<div class="standard"><a id='magicparlabel-282' />
An event loop module is a handle to a library implementing the interfaces of the given event loop type; the mechanism can obtain those interfaces (e.g., as function pointers in the C bindings). Event loops and modules are unspecified in the abstract API, but the intention is that the application passes to the mechanism a handle to the module implementing the chosen event loop interfaces.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.7.1</span> <a id='magicparlabel-283' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-284' />
</div>
<div class='float float-listings'><pre> typedef enum {
     EV_NONE     = 1,
     EV_LIBVERTO = 2,
     EV_LIBEVENT = 4,
     EV_LIBEV    = 8,
     EV_GLIB     = 16,
     EV_TEVENT   = 32,
     EV_GCD      = 64
 } gss_event_loop_type_t;
 
 typedef void *(*gss_dlsym_t)(void *, const char *);
 
 OM_uint32
 gss_set_context_event_loop(OM_uint32 *minor_status,
                            gss_ctx_id_t context,
                            gss_event_loop_type_t event_loop_type,
                            void *event_loop,
                            gss_event_module_type_t event_module_type,
                            void *event_module,
                            gss_dlsym_t module_lookup);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.8</span> <a id='magicparlabel-308' />
GSS_Indicate_event_loop_types()</h3>
<div class="standard"><a id='magicparlabel-309' />
Inputs:</div>

<dl class='description'><dt class="description_label">input_cred_handle&nbsp;CREDENTIAL&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-310' />
 May be GSS_C_NO_CREDENTIAL</dd>
</dl>
<div class="standard"><a id='magicparlabel-311' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-312' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-313' />
minor_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-314' />
event_loop_types SET OF INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-315' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-316' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-317' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-318' />
This function indicates what event loop types are supported the mechanisms for the given credentials handle.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.8.1</span> <a id='magicparlabel-319' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-320' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_indicate_event_loop_types(OM_uint32 *minor_status,
                               gss_cred_id_t input_cred_handle,
                               gss_event_loop_type_t *ev_types);</pre></div>

<h3 class="subsection"><span class="subsection_label">2.9</span> <a id='magicparlabel-328' />
<a id="sub_GSS_Set_context_role_init__" />
GSS_Set_context_role_init()</h3>
<div class="standard"><a id='magicparlabel-329' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-330' />
 Empty security context handle</dd>
<dt class="description_label">mech_type&nbsp;OID</dt>
<dd class="description_item"><a id='magicparlabel-331' />
 Mechanism OID</dd>
<dt class="description_label">target_name&nbsp;NAME</dt>
<dd class="description_item"><a id='magicparlabel-332' />
 Name of target principal</dd>
</dl>
<div class="standard"><a id='magicparlabel-333' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-334' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-335' />
minor_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-336' />
event_loop_types SET OF INTEGER</li>
</ul>
<div class="standard"><a id='magicparlabel-337' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-338' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-339' />
...</li>
<li class="itemize_item"><a id='magicparlabel-340' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-341' />
This function sets the security context role to be that of an initiator, with the given mechanism OID (possibly GSS_C_NO_OID), and the given target name (possibly GSS_C_NO_NAME). The difference between an initiator and an acceptor application is that an initiator application calls this function and an acceptor does not; both call GSS_Step_context() (see Section 2.8). </div>
<h4 class="subsubsection"><span class="subsubsection_label">2.9.1</span> <a id='magicparlabel-342' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-343' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_set_context_context_role_init(OM_uint32 *minor_status,
                                   gss_ctx_id_t context,
                                   gss_const_OID mech_oid,
                                   gss_const_name_t target_name); </pre></div>

<h3 class="subsection"><span class="subsection_label">2.10</span> <a id='magicparlabel-352' />
<a id="sub_GSS_Step_context__" />
GSS_Step_context()</h3>
<div class="standard"><a id='magicparlabel-353' />
Inputs:</div>

<dl class='description'><dt class="description_label">context&nbsp;CONTEXT&nbsp;HANDLE</dt>
<dd class="description_item"><a id='magicparlabel-354' />
 Empty security context</dd>
<dt class="description_label">input_token&nbsp;OCTET&nbsp;STRING</dt>
<dd class="description_item"><a id='magicparlabel-355' />
 Input security context token, if any</dd>
</dl>
<div class="standard"><a id='magicparlabel-356' />
Outputs:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-357' />
major_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-358' />
minor_status INTEGER</li>
<li class="itemize_item"><a id='magicparlabel-359' />
output_token OCTET STRING &ndash; output security context token, if any</li>
<li class="itemize_item"><a id='magicparlabel-360' />
actual_mech OID &ndash; OID of mechanism used</li>
</ul>
<div class="standard"><a id='magicparlabel-361' />
Return major status codes:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-362' />
GSS_S_COMPLETE indicates success.</li>
<li class="itemize_item"><a id='magicparlabel-363' />
GSS_S_CONTINUE_NEEDED ...</li>
<li class="itemize_item"><a id='magicparlabel-364' />
GSS_S_UNAVAILABLE_EVENT_LOOP_TYPE indicates that the application's choice of event loop type is not supported. The mechanism will have done no work in this case, and the application must change the event loop and try again.</li>
<li class="itemize_item"><a id='magicparlabel-365' />
All major status codes allowed for GSS_Init_sec_context() and GSS_Accept_sec_context().</li>
<li class="itemize_item"><a id='magicparlabel-366' />
GSS_S_FAILURE indicates a general failure.</li>
</ul>
<div class="standard"><a id='magicparlabel-367' />
This function steps through one step of security context token exchange for the given security context.</div>

<div class="standard"><a id='magicparlabel-368' />
Acceptors call this without having called GSS_Set_context_role_init(); see <a href="#sub_GSS_Set_context_role_init__">2.9</a>.</div>

<div class="standard"><a id='magicparlabel-369' />
Note that if GSS_S_CONTINUE_NEEDED is returned but no security context is output, then the function must be called again upon async I/O completion notification.</div>
<h4 class="subsubsection"><span class="subsubsection_label">2.10.1</span> <a id='magicparlabel-370' />
C-Bindings</h4>
<div class="standard"><a id='magicparlabel-371' />
</div>
<div class='float float-listings'><pre> OM_uint32
 gss_step_context(OM_uint32 *minor_status,
                  gss_ctx_id_t context,
                  gss_const_buffer_t input_token,
                  gss_buffer_t output_token,
                  gss_const_OID *actual_mech);</pre></div>

<h2 class="section"><span class="section_label">3</span> <a id='magicparlabel-381' />
Security Considerations</h2>
<div class="standard"><a id='magicparlabel-382' />
The GSS-API is a security API, however, this document does not modify its semantics in any security-relevant way. There are no security considerations in this document.</div>
<h2 class="section"><span class="section_label">4</span> <a id='magicparlabel-383' />
IANA Considerations</h2>
<div class="standard"><a id='magicparlabel-384' />
[Add registrations for all the above functions.]</div>
<h2 class="section"><span class="section_label">5</span> <a id='magicparlabel-385' />
<a id="sec_References" />
Normative References</h2>
<div class="standard"><a id='magicparlabel-386' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-390' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">rfc2119</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-391' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-395' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2743.xml">rfc2743</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-396' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-400' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2744.xml">rfc2744</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-401' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-405' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5056.xml">rfc5056</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-406' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-410' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5587.xml">rfc5587</a></div>
</div></div>
<h2 class="section"><span class="section_label">6</span> <a id='magicparlabel-411' />
Informative References</h2>
<div class="standard"><a id='magicparlabel-412' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-416' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5653.xml">rfc5653</a></div>
</div></div>
</body>
</html>
