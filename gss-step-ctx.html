<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en"><head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Simplified and Asynchronous Security Context Interfaces for the Generic Security Services Application Programming Interface</title><style type="text/css" title="Xml2Rfc (sans serif)">
a {
  text-decoration: none;
}
a.smpl {
  color: black;
}
a:hover {
  text-decoration: underline;
}
a:active {
  text-decoration: underline;
}
address {
  margin-top: 1em;
  margin-left: 2em;
  font-style: normal;
}
body {
  color: black;
  font-family: verdana, helvetica, arial, sans-serif;
  font-size: 10pt;
  margin-right: 2em;
}
cite {
  font-style: normal;
}
dl {
  margin-left: 2em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}
dl p {
  margin-left: 0em;
}
dt {
  margin-top: .5em;
}
h1 {
  font-size: 14pt;
  line-height: 21pt;
  page-break-after: avoid;
}
h1.np {
  page-break-before: always;
}
h1 a {
  color: #333333;
}
h2 {
  font-size: 12pt;
  line-height: 15pt;
  page-break-after: avoid;
}
h3, h4, h5, h6 {
  font-size: 10pt;
  page-break-after: avoid;
}
h2 a, h3 a, h4 a, h5 a, h6 a {
  color: black;
}
img {
  margin-left: 3em;
}
li {
  margin-left: 2em;
}
ol {
  margin-left: 2em;
}
ol.la {
  list-style-type: lower-alpha;
}
ol.ua {
  list-style-type: upper-alpha;
}
ol p {
  margin-left: 0em;
}
p {
  margin-left: 2em;
}
pre {
  margin-left: 3em;
  background-color: lightyellow;
  padding: .25em;
  page-break-inside: avoid;
}
pre.text2 {
  border-style: dotted;
  border-width: 1px;
  background-color: #f0f0f0;
  width: 69em;
}
pre.inline {
  background-color: white;
  padding: 0em;
}
pre.text {
  border-style: dotted;
  border-width: 1px;
  background-color: #f8f8f8;
  width: 69em;
}
pre.drawing {
  border-style: solid;
  border-width: 1px;
  background-color: #f8f8f8;
  padding: 2em;
}
table {
  margin-left: 2em;
}
table.header {
  border-spacing: 1px;
  width: 95%;
  font-size: 10pt;
  color: white;
}
td.top {
  vertical-align: top;
}
td.topnowrap {
  vertical-align: top;
  white-space: nowrap; 
}
table.header td {
  background-color: gray;
  width: 50%;
}
table.header a {
  color: white;
}
td.reference {
  vertical-align: top;
  white-space: nowrap;
  padding-right: 1em;
}
thead {
  display:table-header-group;
}
ul.toc, ul.toc ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
}
ul.toc li {
  line-height: 150%;
  font-weight: bold;
  font-size: 10pt;
  margin-left: 0em;
}
ul.toc li li {
  line-height: normal;
  font-weight: normal;
  font-size: 9pt;
  margin-left: 0em;
}
li.excluded {
  font-size: 0pt;
}
ul p {
  margin-left: 0em;
}

.comment {
  background-color: yellow;
}
.center {
  text-align: center;
}
.error {
  color: red;
  font-style: italic;
  font-weight: bold;
}
.figure {
  font-weight: bold;
  text-align: center;
  font-size: 9pt;
}
.filename {
  color: #333333;
  font-weight: bold;
  font-size: 12pt;
  line-height: 21pt;
  text-align: center;
}
.fn {
  font-weight: bold;
}
.hidden {
  display: none;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.title {
  color: #990000;
  font-size: 18pt;
  line-height: 18pt;
  font-weight: bold;
  text-align: center;
  margin-top: 36pt;
}
.vcardline {
  display: block;
}
.warning {
  font-size: 14pt;
  background-color: yellow;
}


@media print {
  .noprint {
    display: none;
  }
  
  a {
    color: black;
    text-decoration: none;
  }

  table.header {
    width: 90%;
  }

  td.header {
    width: 50%;
    color: black;
    background-color: white;
    vertical-align: top;
    font-size: 12pt;
  }

  ul.toc a::after {
    content: leader('.') target-counter(attr(href), page);
  }
  
  ul.ind li li a {
    content: target-counter(attr(href), page);
  }
  
  .print2col {
    column-count: 2;
    -moz-column-count: 2;
    column-fill: auto;
  }
}

@page {
  @top-left {
       content: "Internet-Draft"; 
  } 
  @top-right {
       content: "July 2013"; 
  } 
  @top-center {
       content: "Simple GSS"; 
  } 
  @bottom-left {
       content: "Williams"; 
  } 
  @bottom-center {
       content: "Expires January 17, 2014"; 
  } 
  @bottom-right {
       content: "[Page " counter(page) "]"; 
  } 
}

@page:first { 
    @top-left {
      content: normal;
    }
    @top-right {
      content: normal;
    }
    @top-center {
      content: normal;
    }
}
</style><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Simplified API" href="#rfc.section.2"><link rel="Chapter" title="3 Security Considerations" href="#rfc.section.3"><link rel="Chapter" title="4 IANA Considerations" href="#rfc.section.4"><link rel="Chapter" href="#rfc.section.5" title="5 References"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.580, 2012-06-03 11:18:18, XSLT vendor: SAXON 9.1.0.8 from Saxonica http://www.saxonica.com/"><meta name="keywords" content="Internet-Draft"><link rel="schema.dct" href="http://purl.org/dc/terms/"><meta name="dct.creator" content="Williams, N."><meta name="dct.identifier" content="urn:ietf:id:draft-williams-kitten-ctx-simple-async-01"><meta name="dct.issued" scheme="ISO8601" content="2013-07-16"><meta name="dct.abstract" content="This Internet-Draft proposes extensions to the Generic Security Services Application Programming Interface (GSS-API) for replacing the exiting GSS_Init_sec_context() and GSS_Accept_sec_context() functions with simplified forms that also support asynchrony."><meta name="description" content="This Internet-Draft proposes extensions to the Generic Security Services Application Programming Interface (GSS-API) for replacing the exiting GSS_Init_sec_context() and GSS_Accept_sec_context() functions with simplified forms that also support asynchrony."></head><body><table class="header"><tbody><tr><td class="left">Network Working Group</td><td class="right">N. Williams</td></tr><tr><td class="left">Internet-Draft</td><td class="right">Cryptonector</td></tr><tr><td class="left">Updates: <a href="http://tools.ietf.org/html/rfc2743">2743</a>, <a href="http://tools.ietf.org/html/rfc2744">2744</a> (if approved)</td><td class="right">July 16, 2013</td></tr><tr><td class="left">Intended status: Standards Track</td><td class="right"></td></tr><tr><td class="left">Expires: January 17, 2014</td><td class="right"></td></tr></tbody></table><p class="title">Simplified and Asynchronous Security Context Interfaces for the Generic Security Services Application Programming Interface<br><span class="filename">draft-williams-kitten-ctx-simple-async-01</span></p><h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1><p>This Internet-Draft proposes extensions to the Generic Security Services Application Programming Interface (GSS-API) for replacing the exiting GSS_Init_sec_context() and GSS_Accept_sec_context() functions with simplified forms that also support asynchrony.</p><h1><a id="rfc.status" href="#rfc.status">Status of this Memo</a></h1><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as &#8220;work in progress&#8221;.</p><p>This Internet-Draft will expire on January 17, 2014.</p><h1><a id="rfc.copyrightnotice" href="#rfc.copyrightnotice">Copyright Notice</a></h1><p>Copyright © 2013 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p><hr class="noprint"><h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1><ul class="toc"><li>1.&nbsp;&nbsp;&nbsp;<a href="#d1e314">Introduction</a><ul><li>1.1&nbsp;&nbsp;&nbsp;<a href="#d1e323">Channel Binding Semantics Improvements</a></li><li>1.2&nbsp;&nbsp;&nbsp;<a href="#d1e339">Conventions used in this document</a></li></ul></li><li>2.&nbsp;&nbsp;&nbsp;<a href="#d1e354">Simplified API</a><ul><li>2.1&nbsp;&nbsp;&nbsp;<a href="#d1e407">GSS_Create_sec_context()</a><ul><li>2.1.1&nbsp;&nbsp;&nbsp;<a href="#d1e449">C-Bindings</a></li></ul></li><li>2.2&nbsp;&nbsp;&nbsp;<a href="#d1e462">GSS_Set_context_flags()</a><ul><li>2.2.1&nbsp;&nbsp;&nbsp;<a href="#d1e519">C-Bindings</a></li></ul></li><li>2.3&nbsp;&nbsp;&nbsp;<a href="#d1e532">GSS_Set_context_credentials()</a><ul><li>2.3.1&nbsp;&nbsp;&nbsp;<a href="#d1e581">C-Bindings</a></li></ul></li><li>2.4&nbsp;&nbsp;&nbsp;<a href="#d1e594">GSS_Set_context_channel_bindings()</a><ul><li>2.4.1&nbsp;&nbsp;&nbsp;<a href="#d1e637">C-Bindings</a></li></ul></li><li>2.5&nbsp;&nbsp;&nbsp;<a href="#d1e650">GSS_Set_context_lifetime()</a><ul><li>2.5.1&nbsp;&nbsp;&nbsp;<a href="#d1e693">C-Bindings</a></li></ul></li><li>2.6&nbsp;&nbsp;&nbsp;<a href="#sub_GSS_Indicate_context_events__">GSS_Indicate_context_events()</a><ul><li>2.6.1&nbsp;&nbsp;&nbsp;<a href="#d1e767">C-Bindings</a></li></ul></li><li>2.7&nbsp;&nbsp;&nbsp;<a href="#sub_GSS_Report_context_events__">GSS_Report_context_events()</a><ul><li>2.7.1&nbsp;&nbsp;&nbsp;<a href="#d1e856">C-Bindings</a></li></ul></li><li>2.8&nbsp;&nbsp;&nbsp;<a href="#sub_GSS_Set_context_role_init__">GSS_Set_context_role_init()</a><ul><li>2.8.1&nbsp;&nbsp;&nbsp;<a href="#d1e925">C-Bindings</a></li></ul></li><li>2.9&nbsp;&nbsp;&nbsp;<a href="#sub_GSS_Step_context__">GSS_Step_context()</a><ul><li>2.9.1&nbsp;&nbsp;&nbsp;<a href="#d1e1021">C-Bindings</a></li></ul></li></ul></li><li>3.&nbsp;&nbsp;&nbsp;<a href="#d1e1033">Security Considerations</a></li><li>4.&nbsp;&nbsp;&nbsp;<a href="#d1e1042">IANA Considerations</a></li><li>5.&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a><ul><li>5.1&nbsp;&nbsp;&nbsp;<a href="#rfc.references.1">Normative References</a></li><li>5.2&nbsp;&nbsp;&nbsp;<a href="#rfc.references.2">Informative References</a></li></ul></li><li><a href="#rfc.authors">Author's Address</a></li></ul><hr class="noprint"><h1 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a id="d1e314" href="#d1e314">Introduction</a></h1><p id="rfc.section.1.p.1">We propose replacing the GSS_Init_sec_context() and GSS_Accept_sec_context() functions with a set of simpler functions: one to create an &#8220;empty&#8221; security context, a set of functions to set context parameters, a single function for &#8220;stepping&#8221; the security context token exchange, and additional security context inquiry functions. Support for non-blocking stepping of security context token exchange is also included.</p><h2 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;<a id="d1e323" href="#d1e323">Channel Binding Semantics Improvements</a></h2><p id="rfc.section.1.1.p.1">The extensions specified in this document are a further extension to <a href="#I-D.williams-kitten-channel-bound-flag"><cite title="Channel Binding Signalling for the Generic Security Services Application Programming Interface">[I-D.williams-kitten-channel-bound-flag]</cite></a>.</p><h2 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2</a>&nbsp;<a id="d1e339" href="#d1e339">Conventions used in this document</a></h2><p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p><hr class="noprint"><h1 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a id="d1e354" href="#d1e354">Simplified API</a></h1><p id="rfc.section.2.p.1">We add a function for creating &#8220;empty&#8221; security contexts:</p><p id="rfc.section.2.p.2"> </p><ul><li>GSS_Create_sec_context()</li></ul><p id="rfc.section.2.p.3">We add the following new mutator functions for empty security contexts:</p><p id="rfc.section.2.p.4"> </p><ul><li>GSS_Set_context_flags()</li><li>GSS_Set_context_credentials()</li><li>GSS_Set_context_role_init()</li><li>GSS_Set_context_channel_bindings()</li><li>GSS_Set_context_lifetime()</li><li>GSS_Indicate_context_events()</li><li>GSS_Report_context_events()</li></ul><p id="rfc.section.2.p.5">We add a function for stepping through security context token exchanges:</p><p id="rfc.section.2.p.6"> </p><ul><li>GSS_Step_context()</li></ul><p id="rfc.section.2.p.7">We add a function for retrieving delegated credentials from a security context token:</p><p id="rfc.section.2.p.8"> </p><ul><li>GSS_Get_context_deleg_cred()</li></ul><h2 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a>&nbsp;<a id="d1e407" href="#d1e407">GSS_Create_sec_context()</a></h2><p id="rfc.section.2.1.p.1">Inputs:</p><p id="rfc.section.2.1.p.2"> </p><ul><li>&lt;none&gt;</li></ul><p id="rfc.section.2.1.p.3">Outputs:</p><p id="rfc.section.2.1.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER -- note: mostly useless, but we should keep it</li><li>context SECURITY CONTEXT</li></ul><p id="rfc.section.2.1.p.5">Return major status codes:</p><p id="rfc.section.2.1.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>GSS_S_UNAVAILABLE indicates that memory is not available, for example.</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.1.p.7">This function creates an &#8220;empty&#8221; security context handle that can be passed to GSS_Init_sec_context() or GSS_Accept_sec_context() where they expect a NULL context. The context can also be passed to the other new security context functions defined in this document.</p><h3 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1</a>&nbsp;<a id="d1e449" href="#d1e449">C-Bindings</a></h3><p id="rfc.section.2.1.1.p.2"> </p><div id="rfc.figure.u.1"></div><pre> OM_uint32
 gss_create_sec_context(OM_uint32 *minor_status,
                        gss_ctx_id_t *context);</pre><h2 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2</a>&nbsp;<a id="d1e462" href="#d1e462">GSS_Set_context_flags()</a></h2><p id="rfc.section.2.2.p.1">Inputs:</p><p id="rfc.section.2.2.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dt>req_flags&nbsp;FLAGS</dt><dd>Requested flags. Applicable to acceptors and initiators.</dd><dt>ret_flags_understood&nbsp;FLAGS</dt><dd>Return flags understood by the caller.</dd></dl><p id="rfc.section.2.2.p.3">Outputs:</p><p id="rfc.section.2.2.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li></ul><p id="rfc.section.2.2.p.5">Return major status codes:</p><p id="rfc.section.2.2.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.2.p.7">This function tells the mechanism (when one is eventually chosen and invoked) that the application requests the given req_flags and undestands the given ret_flags. Initiators can override the req_flags in their GSS_Init_sec_context() call, but if no flags are requested there then the req_flags set on the empty context will be used.</p><p id="rfc.section.2.2.p.8">NOTE: The abstract GSS-API <a href="#RFC2743"><cite title="Generic Security Service Application Program Interface Version 2, Update 1">[RFC2743]</cite></a> uses individual elements -one per-flag- instead of a &#8220;FLAGS&#8221; type. This is unwieldy, therefore we introduce an abstract type named &#8220;FLAGS&#8221; to act as a set of all the request/return flags defined for the abstract GSS-API.</p><h3 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1</a>&nbsp;<a id="d1e519" href="#d1e519">C-Bindings</a></h3><p id="rfc.section.2.2.1.p.2"> </p><div id="rfc.figure.u.2"></div><pre> OM_uint32
 gss_set_context_flags(OM_uint32 *minor_status,
                       gss_ctx_id_t context,
                       uint64_t req_flags,
                       uint64_t ret_flags);</pre><h2 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3</a>&nbsp;<a id="d1e532" href="#d1e532">GSS_Set_context_credentials()</a></h2><p id="rfc.section.2.3.p.1">Inputs:</p><p id="rfc.section.2.3.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context</dd><dt>input_cred_handle&nbsp;CREDENTIAL&nbsp;HANDLE</dt><dd>MUST NOT be the default credential.</dd></dl><p id="rfc.section.2.3.p.3">Outputs:</p><p id="rfc.section.2.3.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li></ul><p id="rfc.section.2.3.p.5">Return major status codes:</p><p id="rfc.section.2.3.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>...</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.3.p.7">This function sets the application's credentials. If no credentials are set then the default credentials will be used.</p><p id="rfc.section.2.3.p.8">Multiple credentials may be set on a security context. The mechanism SHOULD allow accepting security contexts for any principals for which credentials had elements for the mechanism used. The mechanism SHOULD allow initiators to have multiple credentials, in which case the mechanism should select the credential most likely to succeed for the given target principal. Where a mechanism does not support multiple credentials it MUST use the first credential handle set by the application.</p><h3 id="rfc.section.2.3.1"><a href="#rfc.section.2.3.1">2.3.1</a>&nbsp;<a id="d1e581" href="#d1e581">C-Bindings</a></h3><p id="rfc.section.2.3.1.p.2"> </p><div id="rfc.figure.u.3"></div><pre> OM_uint32
 gss_set_context_credentials(OM_uint32 *minor_status,
                             gss_ctx_id_t context,
                             gss_const_cred_id_t input_cred_handle);</pre><h2 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4</a>&nbsp;<a id="d1e594" href="#d1e594">GSS_Set_context_channel_bindings()</a></h2><p id="rfc.section.2.4.p.1">Inputs:</p><p id="rfc.section.2.4.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context</dd><dt>input_channel_bindings&nbsp;OCTET&nbsp;STRING</dt></dl><p id="rfc.section.2.4.p.3">Outputs:</p><p id="rfc.section.2.4.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li></ul><p id="rfc.section.2.4.p.5">Return major status codes:</p><p id="rfc.section.2.4.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>...</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><h3 id="rfc.section.2.4.1"><a href="#rfc.section.2.4.1">2.4.1</a>&nbsp;<a id="d1e637" href="#d1e637">C-Bindings</a></h3><p id="rfc.section.2.4.1.p.2"> </p><div id="rfc.figure.u.4"></div><pre> OM_uint32
 gss_set_context_channel_bindings(OM_uint32 *minor_status,
                                  gss_ctx_id_t context,
                                  gss_const_buffer_t input_cb);</pre><h2 id="rfc.section.2.5"><a href="#rfc.section.2.5">2.5</a>&nbsp;<a id="d1e650" href="#d1e650">GSS_Set_context_lifetime()</a></h2><p id="rfc.section.2.5.p.1">Inputs:</p><p id="rfc.section.2.5.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context</dd><dt>lifetime_req&nbsp;INTEGER</dt><dd>...</dd></dl><p id="rfc.section.2.5.p.3">Outputs:</p><p id="rfc.section.2.5.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li></ul><p id="rfc.section.2.5.p.5">Return major status codes:</p><p id="rfc.section.2.5.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>...</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><h3 id="rfc.section.2.5.1"><a href="#rfc.section.2.5.1">2.5.1</a>&nbsp;<a id="d1e693" href="#d1e693">C-Bindings</a></h3><p id="rfc.section.2.5.1.p.2"> </p><div id="rfc.figure.u.5"></div><pre> OM_uint32
 gss_set_context_lifetime(OM_uint32 *minor_status,
                          gss_ctx_id_t context,
                          uint64_t lifetime_req);</pre><h2 id="rfc.section.2.6"><a href="#rfc.section.2.6">2.6</a>&nbsp;<a id="sub_GSS_Indicate_context_events__" href="#sub_GSS_Indicate_context_events__">GSS_Indicate_context_events()</a></h2><p id="rfc.section.2.6.p.1">Inputs:</p><p id="rfc.section.2.6.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context</dd></dl><p id="rfc.section.2.6.p.3">Outputs:</p><p id="rfc.section.2.6.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li><li>read_handles SEQUENCE OF FILE HANDLE</li><li>write_handles SEQUENCE OF FILE HANDLE</li><li>processes SEQUENCE OF PROCESS ID</li><li>signals SEQUENCE OF SIGNAL</li><li>timeout INTEGER</li></ul><p id="rfc.section.2.6.p.5">Return major status codes:</p><p id="rfc.section.2.6.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>...</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.6.p.7">This function indicates the asynchronous events that the mechanism is waiting for, which can be: read and write events on various &#8220;files&#8221; (including TCP, UDP, SCTP, and any other transport), child processes to exit, signals to arrive, and/or a timeout timer to expire. Waiting for a TCP connection to establish can be done by waiting for it to be writable. Waiting for read or write should also be taken to include waiting for end-of-file events in either direction.</p><p id="rfc.section.2.6.p.8">The application should mutate its event loop to wait for these events, and it should report events as they happen using GSS_Report_context_events().</p><h3 id="rfc.section.2.6.1"><a href="#rfc.section.2.6.1">2.6.1</a>&nbsp;<a id="d1e767" href="#d1e767">C-Bindings</a></h3><p id="rfc.section.2.6.1.p.2"> </p><div id="rfc.figure.u.6"></div><pre> #ifdef WIN32
 #include &lt;windows.h&gt;
 #typedef HANDLE gss_pid_t;
 #typedef DWORD gss_pid_status_t;
 #define GSS_C_NO_FILE (-1)
 #define GSS_C_NO_PROC ((gss_pid_t)-1)
 #define GSS_C_NO_SIGNAL (-1)
 #elif _POSIX_C_SOURCE
 #include &lt;unistd.h&gt;
 #typedef pid_t gss_pid_t;
 #typedef int gss_pid_status_t;
 #define GSS_C_NO_FILE (-1)
 #define GSS_C_NO_PROC ((gss_pid_t)-1)
 #define GSS_C_NO_SIGNAL (-1)
 #else
 /* TBD by the operating system */
 #endif
 
 OM_uint32
 gss_indicate_context_events(OM_uint32 *minor_status,
                             gss_ctx_id_t context,
                             int * const *read_fds,
                             int * const *write_fds,
                             gss_pid_t * const *procs,
                             int * const *signals,
                             struct timeval **timeout);</pre><p id="rfc.section.2.6.1.p.3">The events are described by outputting pointers to arrays of file descriptors, process IDs, and signals, terminated by an invalid value (GSS_C_NO_FILE for read_fds[] and write_fds[], GSS_C_NO_PROC for procs[], and GSS_C_NO_SIGNAL for signals[]). The timeout output is a pointer to a struct timeval, set to NULL by the mechanism if it wishes to wait without a timeout (but the application may always impose a timeout of its own).</p><p id="rfc.section.2.6.1.p.4">If the application does not support waiting for any one event type then the application can pass NULL for that output pointer.</p><h2 id="rfc.section.2.7"><a href="#rfc.section.2.7">2.7</a>&nbsp;<a id="sub_GSS_Report_context_events__" href="#sub_GSS_Report_context_events__">GSS_Report_context_events()</a></h2><p id="rfc.section.2.7.p.1">Inputs:</p><p id="rfc.section.2.7.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context</dd><dt>read_handles</dt><dd>SEQUENCE OF FILE HANDLE</dd><dt>write_handles</dt><dd>SEQUENCE OF FILE HANDLE</dd><dt>processes</dt><dd>SEQUENCE OF PROCESS ID</dd><dt>signals</dt><dd>SEQUENCE OF SIGNAL</dd><dt>timedout</dt><dd>BOOLEAN</dd></dl><p id="rfc.section.2.7.p.3">Outputs:</p><p id="rfc.section.2.7.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li></ul><p id="rfc.section.2.7.p.5">Return major status codes:</p><p id="rfc.section.2.7.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>...</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.7.p.7">This function is used by the application to report to the mechanism that some or all of the events requested have completed. Only the events that occurred should be reported.</p><h3 id="rfc.section.2.7.1"><a href="#rfc.section.2.7.1">2.7.1</a>&nbsp;<a id="d1e856" href="#d1e856">C-Bindings</a></h3><p id="rfc.section.2.7.1.p.2"> </p><div id="rfc.figure.u.7"></div><pre> OM_uint32
 gss_indicate_context_events(OM_uint32 *minor_status,
                             gss_ctx_id_t context,
                             const int *read_fds,
                             const int *write_fds,
                             const gss_pid_t *procs,
                             const int *signals,
                             const struct timeval *timeleft);</pre><p id="rfc.section.2.7.1.p.3">The inputs point to variable arrays of file descriptors or process IDs terminated by an invalid value (GSS_C_NO_FILE for read_fds[] and write_fds[], GSS_C_NO_PROC for procs[], and GSS_C_NO_SIGNAL for signals[]), except for timeleft, which is either a NULL pointer (if the application doesn't know how much time was left before timing out) or a pointer to a single struct timeval indicating how much time is left before the mechanism's timeout ({0, 0} to indicate the timeout fired).</p><h2 id="rfc.section.2.8"><a href="#rfc.section.2.8">2.8</a>&nbsp;<a id="sub_GSS_Set_context_role_init__" href="#sub_GSS_Set_context_role_init__">GSS_Set_context_role_init()</a></h2><p id="rfc.section.2.8.p.1">Inputs:</p><p id="rfc.section.2.8.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context handle</dd><dt>mech_type&nbsp;OID</dt><dd>Mechanism OID</dd><dt>target_name&nbsp;NAME</dt><dd>Name of target principal</dd></dl><p id="rfc.section.2.8.p.3">Outputs:</p><p id="rfc.section.2.8.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li></ul><p id="rfc.section.2.8.p.5">Return major status codes:</p><p id="rfc.section.2.8.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>...</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.8.p.7">This function sets the security context role to be that of an initiator, with the given mechanism OID (possibly GSS_C_NO_OID), and the given target name (possibly GSS_C_NO_NAME). The difference between an initiator and an acceptor application is that an initiator application calls this function and an acceptor does not; both call GSS_Step_context() (see Section 2.8).</p><h3 id="rfc.section.2.8.1"><a href="#rfc.section.2.8.1">2.8.1</a>&nbsp;<a id="d1e925" href="#d1e925">C-Bindings</a></h3><p id="rfc.section.2.8.1.p.2"> </p><div id="rfc.figure.u.8"></div><pre> OM_uint32
 gss_set_context_context_role_init(OM_uint32 *minor_status,
                                   gss_ctx_id_t context,
                                   gss_const_OID mech_oid,
                                   gss_const_name_t target_name); </pre><h2 id="rfc.section.2.9"><a href="#rfc.section.2.9">2.9</a>&nbsp;<a id="sub_GSS_Step_context__" href="#sub_GSS_Step_context__">GSS_Step_context()</a></h2><p id="rfc.section.2.9.p.1">Inputs:</p><p id="rfc.section.2.9.p.2"> </p><dl><dt>context&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Empty security context</dd><dt>input_token&nbsp;OCTET&nbsp;STRING</dt><dd>Input security context token, if any</dd><dt>callback&nbsp;CLOSURE</dt><dd>Callback to invoke when mechanism is ready to be called</dd></dl><p id="rfc.section.2.9.p.3">Outputs:</p><p id="rfc.section.2.9.p.4"> </p><ul><li>major_status INTEGER</li><li>minor_status INTEGER</li><li>output_token OCTET STRING -- output security context token, if any</li><li>actual_mech OID -- OID of mechanism used</li></ul><p id="rfc.section.2.9.p.5">Return major status codes:</p><p id="rfc.section.2.9.p.6"> </p><ul><li>GSS_S_COMPLETE indicates success.</li><li>GSS_S_CONTINUE_NEEDED indicates that an output security context token has been produced and an input security context token is needed.</li><li>GSS_S_ASYNC_EVENTS_NEEDED indicates that the mechanism needs to wait for asynchronous events. The application should call GSS_Indicate_context_events() to find out what these events are, wait for them (and possibly other, unrelated events), then report the events that by calling GSS_Report_context_events().</li><li>All major status codes allowed for GSS_Init_sec_context() and GSS_Accept_sec_context().</li><li>GSS_S_CALLBACK_UNSUPPORTED indicates callbacks are not supported; the application must use GSS_Indicate_context_events().</li><li>GSS_S_FAILURE indicates a general failure.</li></ul><p id="rfc.section.2.9.p.7">This function steps through one step of security context token exchange for the given security context.</p><p id="rfc.section.2.9.p.8">Acceptors call this without having called GSS_Set_context_role_init(); see <a href="#sub_GSS_Set_context_role_init__" title="GSS_Set_context_role_init()">Section&nbsp;2.8</a>.</p><p id="rfc.section.2.9.p.9">If a null closure is passed as the callback then the application must call GSS_Indicate_context_events() <a href="#sub_GSS_Indicate_context_events__" title="GSS_Indicate_context_events()">Section&nbsp;2.6</a> to get the set of events to wait for on behalf of the mechanism, wait for said events, then report the results with GSS_Report_context_events() <a href="#sub_GSS_Report_context_events__" title="GSS_Report_context_events()">Section&nbsp;2.7</a>. Else the mechanism must return GSS_S_ASYNC_EVENTS_NEEDED when it needs to wait for asynchronous events, and must call the application back via its closure. The mechanism may not require the use of a callback closure -- the mechanism must support the use of application-managed event loops via GSS_Indicate/Report_context_events().</p><h3 id="rfc.section.2.9.1"><a href="#rfc.section.2.9.1">2.9.1</a>&nbsp;<a id="d1e1021" href="#d1e1021">C-Bindings</a></h3><p id="rfc.section.2.9.1.p.2"> </p><div id="rfc.figure.u.9"></div><pre> OM_uint32
 gss_step_context(OM_uint32 *minor_status,
                  gss_ctx_id_t context,
                  gss_const_buffer_t input_token,
                  gss_buffer_t output_token,
                  gss_const_OID *actual_mech
                  void (*callback)(gss_ctx_id_t, void *),
                  void *callback_data);</pre><hr class="noprint"><h1 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a id="d1e1033" href="#d1e1033">Security Considerations</a></h1><p id="rfc.section.3.p.1">The GSS-API is a security API, however, this document does not modify its semantics in any security-relevant way. There are no security considerations in this document.</p><hr class="noprint"><h1 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a id="d1e1042" href="#d1e1042">IANA Considerations</a></h1><p id="rfc.section.4.p.1">[Add registrations for all the above functions, types, and constants.]</p><hr class="noprint"><h1 id="rfc.references" class="np"><a id="rfc.section.5" href="#rfc.section.5">5.</a> References</h1><h2 class="np" id="rfc.references.1"><a href="#rfc.section.5.1" id="rfc.section.5.1">5.1</a> Normative References</h2><table><tr><td class="reference"><b id="RFC2119">[RFC2119]</b></td><td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, &#8220;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>&#8221;, BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr><tr><td class="reference"><b id="RFC2743">[RFC2743]</b></td><td class="top"><a href="mailto:jlinn@rsasecurity.com" title="RSA Laboratories">Linn, J.</a>, &#8220;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>&#8221;, RFC&nbsp;2743, January&nbsp;2000.</td></tr><tr><td class="reference"><b id="RFC2744">[RFC2744]</b></td><td class="top"><a href="mailto:John_Wray@Iris.com" title="Iris Associates">Wray, J.</a>, &#8220;<a href="http://tools.ietf.org/html/rfc2744">Generic Security Service API Version 2 : C-bindings</a>&#8221;, RFC&nbsp;2744, January&nbsp;2000.</td></tr><tr><td class="reference"><b id="RFC5056">[RFC5056]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>&#8221;, RFC&nbsp;5056, November&nbsp;2007.</td></tr><tr><td class="reference"><b id="RFC5587">[RFC5587]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/rfc5587">Extended Generic Security Service Mechanism Inquiry APIs</a>&#8221;, RFC&nbsp;5587, July&nbsp;2009.</td></tr><tr><td class="reference"><b id="I-D.williams-kitten-channel-bound-flag">[I-D.williams-kitten-channel-bound-flag]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/draft-williams-kitten-channel-bound-flag-02">Channel Binding Signalling for the Generic Security Services Application Programming Interface</a>&#8221;, Internet-Draft&nbsp;draft-williams-kitten-channel-bound-flag-02 (work in progress), February&nbsp;2013.</td></tr></table><h2 id="rfc.references.2"><a href="#rfc.section.5.2" id="rfc.section.5.2">5.2</a> Informative References</h2><table><tr><td class="reference"><b id="RFC5653">[RFC5653]</b></td><td class="top">Upadhyay, M. and S. Malkani, &#8220;<a href="http://tools.ietf.org/html/rfc5653">Generic Security Service API Version 2: Java Bindings Update</a>&#8221;, RFC&nbsp;5653, August&nbsp;2009.</td></tr></table><hr class="noprint"><div class="avoidbreak"><h1 id="rfc.authors" class="np"><a href="#rfc.authors">Author's Address</a></h1><address class="vcard"><span class="vcardline"><span class="fn">Nicolas Williams</span><span class="n hidden"><span class="family-name">Williams</span><span class="given-name">Nicolas</span></span></span><span class="org vcardline">Cryptonector, LLC</span><span class="vcardline">EMail: <a href="mailto:nico@cryptonector.com"><span class="email">nico@cryptonector.com</span></a></span></address></div></body></html>